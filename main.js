(()=>{var c;function n(){return c||(c=new p),c}var p=class{constructor(){this.actionsToKeys=new Map([[0,"ArrowRight"],[1,"ArrowLeft"],[2,"ArrowDown"],[3,"ArrowUp"]]);this.keys=new Map;window.addEventListener("keydown",e=>{this.handleEvent(e)}),window.addEventListener("keyup",e=>{this.handleEvent(e)})}handleEvent(e){this.keys.set(e.key,e.type==="keydown"?3:2)}Update(){for(let e of this.keys.keys())this.keys.set(e,this.keys.get(e)&1)}Get(e){let t=this.actionsToKeys.get(e);return t?this.keys.get(t):0}};var v=class{constructor(){this.state=new Map}Update(e){this.stateLogic(),this.state.get(0)&&e.x++,this.state.get(1)&&e.x--,this.state.get(2)&&e.y++,this.state.get(3)&&e.y--}};var s=class extends v{constructor(t=n()){super();this.inputService=t}stateLogic(){this.state.set(0,!!(this.inputService.Get(0)&1)),this.state.set(1,!!(this.inputService.Get(1)&1)),this.state.set(2,!!(this.inputService.Get(2)&1)),this.state.set(3,!!(this.inputService.Get(3)&1))}};var o=class{constructor(){this.components=[new s];this.x=0;this.y=0}Update(){for(let e of this.components)e.Update(this)}};function u(){return[new o]}var h;function l(){return h||(h=new d),h}var d=class{constructor(){this.canvas=document.getElementById("c"),this.ctx=this.canvas.getContext("2d"),this.resize(),window.addEventListener("resize",()=>this.resize())}resize(){let e,t;e=window.innerWidth/this.canvas.width,t=window.innerHeight/this.canvas.height;let i=Math.min(e,t);i>=1&&(i=Math.floor(i)),this.canvas.style.width=`${this.canvas.width*i}px`,this.canvas.style.height=`${this.canvas.height*i}px`}Clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}DrawSprite(e,t){this.ctx.fillStyle="#f0F",this.ctx.fillRect(e,t,32,32)}};var a=class{constructor(e=n(),t=l()){this.inputService=e;this.renderService=t;this.entities=[];this.scene=u;requestAnimationFrame(i=>{this.start=i,this.frame(i)})}frame(e){this.scene!=null&&(this.entities=this.scene(),this.scene=null),this.Update(),this.Draw(),requestAnimationFrame(t=>{this.frame(t-this.start),this.start=t})}Update(){for(let e of this.entities)e.Update();this.inputService.Update()}Draw(){this.renderService.Clear();for(let e of this.entities)this.renderService.DrawSprite(e.x,e.y)}};window.addEventListener("load",()=>{let r=new a});})();
